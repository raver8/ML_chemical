(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40072,        886]
NotebookOptionsPosition[     36680,        822]
NotebookOutlinePosition[     37074,        838]
CellTagsIndexPosition[     37031,        835]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Goal:  Perform automated tests of the chemical dictionaries ", "Text",
 CellChangeTimes->{{3.9037730288994703`*^9, 3.903773035195613*^9}, {
  3.903773072442268*^9, 
  3.903773078524925*^9}},ExpressionUUID->"925c1885-c287-4ece-b81e-\
bc46194e91c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dictionaryFiles", " ", "=", " ", 
  RowBox[{
  "FileNames", "[", "\"\<../chemical_dictionaries/*.json\>\"", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"#", ",", "\"\<Dataset\>\""}], "]"}], "&"}], "/@", 
    "dictionaryFiles"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903769541880354*^9, 3.903769588375108*^9}, {
  3.9037699188670263`*^9, 3.903769936325851*^9}},
 CellLabel->
  "In[528]:=",ExpressionUUID->"db7113a8-effc-40c0-af70-fa30b71f7276"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records.json\"\>", 
   ",", "\<\"../chemical_dictionaries/chem_dictionary_records_OV.json\"\>", 
   ",", "\<\"../chemical_dictionaries/chem_dictionary_records_RM.json\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9037695895376463`*^9, 3.903769937213243*^9, 
  3.90492277229662*^9, 3.9052698862078037`*^9, 3.905512713080083*^9, 
  3.90551285438239*^9, 3.90551925165237*^9, 3.905519391784388*^9, 
  3.90551973011977*^9, 3.905520181723352*^9, 3.9055205896879673`*^9, 
  3.905520685809984*^9, 3.905520760995063*^9, 3.9055214426448383`*^9, 
  3.905521483743579*^9, 3.9055216490667267`*^9, 3.905521854489809*^9, 
  3.905522150635949*^9, 3.9055243568473673`*^9, 3.905524518116994*^9},
 CellLabel->
  "Out[529]=",ExpressionUUID->"0c7e85e0-8322-41cf-95cd-e6b6ca6ac73c"]
}, Open  ]],

Cell["\<\
How many compounds are there in total? (including potential duplicates):\
\>", "Text",
 CellChangeTimes->{{3.903774537668683*^9, 
  3.9037745581637487`*^9}},ExpressionUUID->"cbf1fb47-5901-43e6-bcb6-\
e2facc7a0561"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "/@", "data"}], "//", "Total"}]], "Input",
 CellChangeTimes->{{3.9037745253959827`*^9, 3.903774535776394*^9}},
 CellLabel->
  "In[531]:=",ExpressionUUID->"e429c4d5-65bf-4ad2-b5e0-14471adbc965"],

Cell[BoxData["166"], "Output",
 CellChangeTimes->{{3.903774532216555*^9, 3.903774535949027*^9}, 
   3.904922772437641*^9, 3.9052698881954823`*^9, 3.9055127131728*^9, 
   3.905512854436406*^9, 3.9055192517156363`*^9, 3.905519391836187*^9, 
   3.905519730173358*^9, 3.9055201817727747`*^9, 3.905520589740546*^9, 
   3.9055206858597393`*^9, 3.9055207610465307`*^9, 3.905521442722355*^9, 
   3.90552148379845*^9, 3.905521649121346*^9, 3.9055218545415487`*^9, 
   3.905522150688171*^9, 3.9055243569027767`*^9, 3.905524518172125*^9},
 CellLabel->
  "Out[531]=",ExpressionUUID->"420f627a-e018-49de-a708-888355f07301"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checks", "Section",
 CellChangeTimes->{{3.9037699110227337`*^9, 3.903769912774143*^9}, 
   3.9037708649905167`*^9},ExpressionUUID->"d80460e8-fc45-4104-a610-\
9bd97b802477"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "check", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"check", "[", "test_", "]"}], "[", "data_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tests", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"VerificationTest", "[", 
           RowBox[{"test", "[", "#", "]"}], "]"}], "&"}], "/@", "data"}], "//",
         "Normal"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"errors", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"TestReport", "[", "tests", "]"}], "[", 
            "\"\<ResultsByOutcome\>\"", "]"}], "//", "\[IndentingNewLine]", 
           RowBox[{"Lookup", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Error\>\"", ",", "\"\<Failure\>\""}], "}"}], 
            "]"}]}], "//", "Flatten"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", "\"\<Input\>\"", "]"}], "]"}], "&"}], ",", 
         "errors", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"failureSummary", "[", 
   RowBox[{"test_", ",", "fileNames_List", ",", "data_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"AssociationThread", "[", 
   RowBox[{"fileNames", "->", 
    RowBox[{"(", 
     RowBox[{"test", "/@", "data"}], ")"}]}], " ", "]"}]}]}], "Input",
 CellChangeTimes->{{3.903773899297908*^9, 3.903773900280764*^9}, 
   3.903774573180787*^9, {3.905329950665182*^9, 3.905329951024729*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"84bba290-fb89-4efc-b0f1-6ddcc7684a09"],

Cell[CellGroupData[{

Cell["Every pure substance has a valid InChI or SMILES identifiers", \
"Subsection",
 CellChangeTimes->{{3.9037708692237463`*^9, 3.903770877221579*^9}, {
  3.9037709973132353`*^9, 3.903770998477841*^9}, {3.9052699147097807`*^9, 
  3.90526992902134*^9}},ExpressionUUID->"28762df5-e4b4-4f72-99ad-\
c524ac3638b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pureSubstanceQ", "[", "row_", "]"}], ":=", 
   RowBox[{"row", "[", "\"\<pure substance\>\"", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "validSMILESQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "validInChIQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"validSMILESQ", "[", 
   RowBox[{"row_", "?", "pureSubstanceQ"}], "]"}], ":=", 
  RowBox[{"Not", "@", 
   RowBox[{"FailureQ", "@", 
    RowBox[{"Molecule", "@", 
     RowBox[{
     "row", "[", "\"\<SMILES\>\"", "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"validSMILESQ", "[", "row_", "]"}], ":=", "True"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"if", " ", "not", " ", "a", " ", "pure", " ", "substance"}], ",", 
    " ", 
    RowBox[{"then", " ", "we", " ", "can", " ", "ignore"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"validInChIQ", "[", 
   RowBox[{"row_", "?", "pureSubstanceQ"}], "]"}], ":=", 
  RowBox[{"Not", "@", 
   RowBox[{"FailureQ", "@", 
    RowBox[{"Molecule", "@", 
     RowBox[{
     "row", "[", "\"\<InChI\>\"", "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"validInChIQ", "[", "row_", "]"}], ":=", "True"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"if", " ", "not", " ", "a", " ", "pure", " ", "substance"}], ",", 
    " ", 
    RowBox[{"then", " ", "we", " ", "can", " ", "ignore"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"failureSummary", "[", 
  RowBox[{
   RowBox[{"check", "[", "validSMILESQ", "]"}], ",", "dictionaryFiles", ",", 
   "data"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"failureSummary", "[", 
   RowBox[{
    RowBox[{"check", "[", "validInChIQ", "]"}], ",", "dictionaryFiles", ",", 
    "data"}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"how", " ", "many", " ", "total", " ", "errors", " ", "are", " ", 
    RowBox[{"there", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "@", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Values", "@", "#"}]}]}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"%", ",", "%%"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.903770882722036*^9, 3.903770900877434*^9}, {
   3.9037709388936377`*^9, 3.903771099371002*^9}, {3.903771149242797*^9, 
   3.903771227845159*^9}, {3.9037713187517433`*^9, 3.903771328144114*^9}, {
   3.903771368957226*^9, 3.903771447418405*^9}, {3.9037715954507113`*^9, 
   3.9037716839895573`*^9}, {3.903771745821966*^9, 3.90377178622689*^9}, {
   3.903771848865177*^9, 3.903771884742237*^9}, {3.903771929089019*^9, 
   3.9037720553078547`*^9}, {3.90377216297621*^9, 3.90377216913231*^9}, {
   3.903772235812373*^9, 3.903772307164336*^9}, {3.9037725837566757`*^9, 
   3.9037725969817038`*^9}, {3.903772810235634*^9, 3.903772873435321*^9}, {
   3.903772934817665*^9, 3.903772979427052*^9}, {3.9037730906293793`*^9, 
   3.903773184039317*^9}, {3.90377389395252*^9, 3.9037739026064672`*^9}, {
   3.903774050027562*^9, 3.903774084496619*^9}, 3.903774119370734*^9, {
   3.903774165550043*^9, 3.903774196127981*^9}, {3.9037743730532427`*^9, 
   3.903774440105673*^9}, {3.9037745954757233`*^9, 3.903774630344418*^9}, {
   3.9053299557620983`*^9, 3.9053299628874903`*^9}},
 CellLabel->
  "In[535]:=",ExpressionUUID->"5ab76055-3318-401c-8e6a-03891cd63381"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records.json\"\>", 
    "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_OV.json\"\>",
     "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_RM.json\"\>",
     "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.90377229778087*^9, 3.903772308094358*^9}, {
   3.903772852117309*^9, 3.903772874049094*^9}, {3.903772936425709*^9, 
   3.90377298125014*^9}, 3.90377316747997*^9, 3.903774125294924*^9, 
   3.903774166850526*^9, 3.90377421491084*^9, 3.903774409597981*^9, 
   3.90377444055267*^9, 3.9037746309255342`*^9, 3.9049227730981407`*^9, 
   3.9052698938927097`*^9, 3.905329973611951*^9, 3.9055127132683067`*^9, 
   3.905512854528122*^9, 3.905519251807212*^9, 3.905519391942568*^9, 
   3.905519730260276*^9, 3.905520181876643*^9, 3.905520589825951*^9, 
   3.905520685945826*^9, 3.9055207611507998`*^9, 3.90552144281048*^9, 
   3.905521483887116*^9, 3.905521649208727*^9, 3.9055218546478786`*^9, 
   3.9055221507749033`*^9, 3.905524356989785*^9, 3.9055245182580757`*^9},
 CellLabel->
  "Out[542]=",ExpressionUUID->"617d9ae4-9e52-4e97-90e5-74539a6431af"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records.json\"\>", 
    "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_OV.json\"\>",
     "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_RM.json\"\>",
     "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.90377229778087*^9, 3.903772308094358*^9}, {
   3.903772852117309*^9, 3.903772874049094*^9}, {3.903772936425709*^9, 
   3.90377298125014*^9}, 3.90377316747997*^9, 3.903774125294924*^9, 
   3.903774166850526*^9, 3.90377421491084*^9, 3.903774409597981*^9, 
   3.90377444055267*^9, 3.9037746309255342`*^9, 3.9049227730981407`*^9, 
   3.9052698938927097`*^9, 3.905329973611951*^9, 3.9055127132683067`*^9, 
   3.905512854528122*^9, 3.905519251807212*^9, 3.905519391942568*^9, 
   3.905519730260276*^9, 3.905520181876643*^9, 3.905520589825951*^9, 
   3.905520685945826*^9, 3.9055207611507998`*^9, 3.90552144281048*^9, 
   3.905521483887116*^9, 3.905521649208727*^9, 3.9055218546478786`*^9, 
   3.9055221507749033`*^9, 3.905524356989785*^9, 3.90552451838509*^9},
 CellLabel->
  "Out[543]=",ExpressionUUID->"36115a02-1e70-4f40-8504-ad405b6c2c14"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.90377229778087*^9, 3.903772308094358*^9}, {
   3.903772852117309*^9, 3.903772874049094*^9}, {3.903772936425709*^9, 
   3.90377298125014*^9}, 3.90377316747997*^9, 3.903774125294924*^9, 
   3.903774166850526*^9, 3.90377421491084*^9, 3.903774409597981*^9, 
   3.90377444055267*^9, 3.9037746309255342`*^9, 3.9049227730981407`*^9, 
   3.9052698938927097`*^9, 3.905329973611951*^9, 3.9055127132683067`*^9, 
   3.905512854528122*^9, 3.905519251807212*^9, 3.905519391942568*^9, 
   3.905519730260276*^9, 3.905520181876643*^9, 3.905520589825951*^9, 
   3.905520685945826*^9, 3.9055207611507998`*^9, 3.90552144281048*^9, 
   3.905521483887116*^9, 3.905521649208727*^9, 3.9055218546478786`*^9, 
   3.9055221507749033`*^9, 3.905524356989785*^9, 3.905524518386348*^9},
 CellLabel->
  "Out[544]=",ExpressionUUID->"5b0d4cc4-2021-4893-b045-3569bea1928f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
InChI is consistent with SMILES and InChI is consistent with given InChIKey\
\>", "Subsection",
 CellChangeTimes->{{3.903769984527486*^9, 3.9037699982620897`*^9}, {
  3.905270533225141*^9, 3.905270537719932*^9}, {3.905270811171504*^9, 
  3.905270816087294*^9}},ExpressionUUID->"319f24c7-668c-4a30-889d-\
8af936bafdfc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"consistentSMILESInChIQ", "[", 
    RowBox[{"row_", "?", "pureSubstanceQ"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"inchiMol", "=", 
        RowBox[{"Molecule", "@", 
         RowBox[{"row", "[", "\"\<InChI\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"smilesMol", " ", "=", " ", 
        RowBox[{"Molecule", "@", 
         RowBox[{"row", "[", "\"\<SMILES\>\"", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MoleculeEquivalentQ", "[", 
      RowBox[{"inchiMol", ",", "smilesMol"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"consistentInChIKeyInChIQ", "[", 
    RowBox[{"row_", "?", "pureSubstanceQ"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"computedKey", "=", 
        RowBox[{"Last", "@", 
         RowBox[{
          RowBox[{"MoleculeProperty", "[", "\"\<InChIKey\>\"", "]"}], "@", 
          RowBox[{"Molecule", "@", 
           RowBox[{"row", "[", "\"\<InChI\>\"", "]"}]}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"givenKey", " ", "=", " ", 
        RowBox[{"row", "[", "\"\<InChIKey\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"givenKey", " ", "==", " ", "computedKey"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "ignore", " ", "molecules", " ", "without", " ", "representation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"consistentSMILESInChIQ", "[", "row_", "]"}], ":=", 
  "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"consistentInChIKeyInChIQ", "[", "row_", "]"}], ":=", "True"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"failureSummary", "[", 
  RowBox[{
   RowBox[{"check", "[", "consistentSMILESInChIQ", "]"}], ",", 
   "dictionaryFiles", ",", "data"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"failureSummary", "[", 
   RowBox[{
    RowBox[{"check", "[", "consistentInChIKeyInChIQ", "]"}], ",", 
    "dictionaryFiles", ",", "data"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"how", " ", "many", " ", "total", " ", "errors", " ", "are", " ", 
    RowBox[{"there", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "@", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Values", "@", "#"}]}]}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"%", ",", "%%"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.903770028513144*^9, 3.903770038742009*^9}, {
  3.903770079871175*^9, 3.9037702052724953`*^9}, {3.903770283561221*^9, 
  3.9037702942178917`*^9}, {3.903770337497718*^9, 3.903770737098452*^9}, {
  3.903770791592846*^9, 3.903770799549914*^9}, {3.903770854211561*^9, 
  3.903770859333911*^9}, {3.905270147918522*^9, 3.905270322777467*^9}, {
  3.905270391574106*^9, 3.905270491343895*^9}, {3.9052705453889713`*^9, 
  3.905270654997201*^9}, {3.90527071336614*^9, 3.905270792536413*^9}, {
  3.905329977756258*^9, 3.905329984853166*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"3f969449-edf4-4c2b-bfd2-7eb46e654ba9"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records.json\"\>", 
    "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> {AMMONIUM NITRATE, \
6484-52-2, Norway Saltpeter, Ammonium Nitricum, Ammonium Saltpeter, Nitrate \
Of Ammonia, Nitric Acid Ammonium Salt, Azanium Nitrate}, pure substance -> \
True, CAS -> 6484-52-2, SMILES -> [N+](=O)([O-])[O-].[NH4+], InChIKey -> \
DVARTQFDIMZBAA-UHFFFAOYSA-O, InChI -> \
InChI=1S/NO3.H3N/c2-1(3)4;/h;1H3/q-1;/p+1, PubchemCID -> 22985, URL -> \
https://pubchem.ncbi.nlm.nih.gov/compound/22985|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> \
{N1,N3-di(hexa-1,3,5-triyn-1-yl)-N1,N3-dimethylmalonamide--dihydrogen \
(1/10)}, pure substance -> True, CAS -> missing, SMILES -> \
CN(C#CC#CC#C)C(CC(N(C#CC#CC#C)C)=O)=O.[HH].[HH].[HH].[HH].[HH].[HH].[HH].[HH].\
[HH].[HH], InChIKey -> TYNJUWGQVWVVPE-UHFFFAOYSA-N, InChI -> \
InChI=1S/C17H10N2O2/c1-5-7-9-11-13-18(3)16(20)15-17(21)19(4)14-12-10-8-6-2/h1-\
2H,15H2,3-4H3, PubchemCID -> missing, URL -> missing|>]\"\>", "]"}]}], 
     "}"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_OV.json\"\>",
     "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> \
{N,N'-dimethyl-N,N'-diphenyl-malonamide, MA, \
N,N'-dimethyl-N,N'-diphenylpropanediamide, 36949-57-2}, pure substance -> \
True, CAS -> 36949-57-2, InChIKey -> HFVHOHNNXRSOBQ-UHFFFAOYSA-N, InChI -> \
InChI=1S/C17H18N2O2/c1-18(14-9-5-3-6-10-14)16(20)13-17(21)19(2)15-11-7-4-8-12-\
15/h3-12H,13H2,1-2H3, SMILES -> \
CCOC(C)C1=C(C=CC(=C1)C)N(C2=CC=C(C=C2)C)C(=O)CC(=O)N, PubchemCID -> 10869752, \
URL -> https://pubchem.ncbi.nlm.nih.gov/compound/10869752|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> {N,N'-dimethyl- \
N,N'-diphenyl-diglycolamide, DGA}, pure substance -> True, CAS -> missing, \
InChIKey -> HIELYQQIYOVIAZ-UHFFFAOYSA-N, InChI -> \
InChI=1S/C18H20N2O3/c1-19(15-9-5-3-6-10-15)17(21)13-23-14-18(22)20(2)16-11-7-\
4-8-12-16/h3-12H,13-14H2,1-2H3, SMILES -> \
CN(C(COCC(N(C(C)=C)C)=O)=O)C1=CC=CC=C1.C, PubchemCID -> missing, URL -> \
https://opsin.ch.cam.ac.uk|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> \
{N-(3,4,5-trimethylphenyl)-1,10-phenanthroline-2-carboxamide, \
N-(3,4,5-trimethylphenyl)1,10-phenanthroline-2-carboxamide}, pure substance \
-> True, CAS -> missing, InChIKey -> BLBKIQITDWHHRS-UHFFFAOYSA-N, InChI -> \
InChI=1S/C22H19N3O/c1-13-11-18(12-14(2)15(13)3)24-22(26)19-9-8-17-7-6-16-5-4-\
10-23-20(16)21(17)25-19/h4-12H,1-3H3,(H,24,26), SMILES -> \
CC=1C=C(C=C(C1C)C)NC(=O)C1=NC2=C3N=CC=CC3=CC=C2C=C1, PubchemCID -> missing, \
URL -> missing|>]\"\>", "]"}]}], "}"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_RM.json\"\>",
     "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> \
{N,N'-dibutyl-N,N'-di(1-methylheptyl)-diglycolamide, (DBD1MHDGA), \
2,2'-oxybis(N-butyl-N-(heptan-2-yl)acetamide)}, pure substance -> True, CAS \
-> MISSING, InChIKey -> SNDPSFAOXBZUOZ-UHFFFAOYSA-N, InChI -> \
InChI=1S/C28H56N2O3/c1-7-11-15-17-19-25(5)29(21-13-9-3)27(31)23-33-24-28(32)\
30(22-14-10-4)26(6)20-18-16-12-8-2/h25-26H,7-24H2,1-6H3, SMILES -> \
O(CC(=O)N(CCCC)C(C)CCCCC)CC(=O)N(C(C)CCCCC)CCCC, PubchemCID -> MISSING, URL \
-> MISSING|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> {N2 ,N9 -Diethyl-N2 ,N9 \
-diphenyl-1,10-phenanthroline-2,9- dicarboxamide, N2 ,N9-Diethyl-N2 \
,N9-diphenyl-1,10-phenanthroline-2,9-dicarboxamide}, pure substance -> True, \
CAS -> MISSING, InChIKey -> UASDBTAQQPJEMV-UHFFFAOYSA-N, InChI -> \
InChI=1S/C30H28N4O2/c1-3-30(29(36)31-23-11-7-5-8-12-23)20-19-22-16-15-21-17-\
18-25(32-26(21)27(22)33-30)28(35)34(4-2)24-13-9-6-10-14-24/h5-20,33H,3-4H2,1-\
2H3,(H,31,36), SMILES -> \
C(C)N(C(=O)C1=NC2=C3N=C(C=CC3=CC=C2C=C1)C(=O)N(C1=CC=CC=C1)CC)C1=CC=CC=C1, \
PubchemCID -> MISSING, URL -> MISSING|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentSMILESInChIQ[<|names -> \
{2,2'-(4-(dodecyloxy)pyridine-2,6-diyl)bis(benzo[d]thiazole), \
2-[6-(1,3-benzothiazol-2-yl)-4-dodecoxypyridin-2-yl]-1,3-benzothiazole, \
2-[2-(1,3-benzothiazol-2-yl)-4-dodecoxypyridin-6-yl]-1,3-benzothiazole}, pure \
substance -> True, CAS -> MISSING, InChIKey -> UQSLRNLLBLUSIF-UHFFFAOYSA-N, \
InChI -> InChI=1S/C31H35N3OS2/c1-2-3-4-5-6-7-8-9-10-15-20-35-23-21-26(30-33-\
24-16-11-13-18-28(24)36-30)32-27(22-23)31-34-25-17-12-14-19-29(25)37-31/h11-\
14,16-19,21-22H,2-10,15,20H2,1H3, SMILES -> \
S1C(=NC2=C1C=CC=C2)C2=CC(=CC(=N2)C=2SC1=C(N2)C=CC=C1)OCCCCCCCCCCCCF, \
PubchemCID -> 135021846, URL -> \
https://pubchem.ncbi.nlm.nih.gov/compound/135021846|>]\"\>", "]"}]}], 
     "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.903770189745874*^9, 3.903770205567177*^9}, {
   3.903770443255468*^9, 3.903770452028363*^9}, {3.9037706913333197`*^9, 
   3.903770705856444*^9}, 3.903770744544853*^9, 3.903770836100936*^9, 
   3.90492277363162*^9, 3.9052699653297987`*^9, 3.905270248720551*^9, 
   3.905270493746697*^9, 3.9052706591858788`*^9, 3.9052707887103367`*^9, 
   3.905329987258053*^9, 3.905512713741136*^9, 3.905512855005275*^9, 
   3.9055192522803783`*^9, 3.90551939240362*^9, 3.905519730710924*^9, 
   3.9055201823250027`*^9, 3.905520590271069*^9, 3.905520686389163*^9, 
   3.9055207615931273`*^9, 3.905521443263473*^9, 3.905521484340061*^9, 
   3.905521649662311*^9, 3.905521855099844*^9, 3.905522151225142*^9, 
   3.905524357441049*^9, 3.905524518709927*^9},
 CellLabel->
  "Out[549]=",ExpressionUUID->"93ac58a7-c314-4b56-b15c-3ba2fa704b0e"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records.json\"\>", 
    "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentInChIKeyInChIQ[<|names -> \
{2-ethyl-1-hexyl(2-ethyl-1-hexyl)phosphonic acid, HEH[EHP], \
2-ethylhexylphosphonic acid mono-2-ethylhexyl ester}, pure substance -> True, \
CAS -> 14082-03-0, SMILES -> C(C)C(COP(O)(=O)CC(CCCC)CC)CCCC, InChiKey -> \
ZDFBXXSHBTVQMB-UHFFFAOYSA-N, InChI -> \
InChI=1S/C16H35O3P/c1-5-9-11-15(7-3)13-19-20(17,18)14-16(8-4)12-10-6-2/h15-\
16H,5-14H2,1-4H3,(H,17,18), PubchemCID -> 85771, URL -> \
https://pubchem.ncbi.nlm.nih.gov/compound/85771|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentInChIKeyInChIQ[<|names -> {AMMONIUM NITRATE, \
6484-52-2, Norway Saltpeter, Ammonium Nitricum, Ammonium Saltpeter, Nitrate \
Of Ammonia, Nitric Acid Ammonium Salt, Azanium Nitrate}, pure substance -> \
True, CAS -> 6484-52-2, SMILES -> [N+](=O)([O-])[O-].[NH4+], InChIKey -> \
DVARTQFDIMZBAA-UHFFFAOYSA-O, InChI -> \
InChI=1S/NO3.H3N/c2-1(3)4;/h;1H3/q-1;/p+1, PubchemCID -> 22985, URL -> \
https://pubchem.ncbi.nlm.nih.gov/compound/22985|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentInChIKeyInChIQ[<|names -> \
{2-ethyl-1-hexyl(2-ethyl-1-hexyl)phosphonic acid, HEH[EHP], \
2-ethylhexylphosphonic acid mono-2-ethylhexyl ester}, pure substance -> True, \
CAS -> 14082-03-0, SMILES -> C(C)C(COP(O)(=O)CC(CCCC)CC)CCCC, InChiKey -> \
ZDFBXXSHBTVQMB-UHFFFAOYSA-N, InChI -> \
InChI=1S/C16H35O3P/c1-5-9-11-15(7-3)13-19-20(17,18)14-16(8-4)12-10-6-2/h15-\
16H,5-14H2,1-4H3,(H,17,18), PubchemCID -> 85771, URL -> \
https://pubchem.ncbi.nlm.nih.gov/compound/85771|>]\"\>", "]"}]}], "}"}]}], 
   ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_OV.json\"\>",
     "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_RM.json\"\>",
     "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentInChIKeyInChIQ[<|names -> \
{2-(6-(1H-benzo[d]imidazol-2-yl)pyridin-2-yl)-1-hexyl-1H-benzo[d]imidazole, \
2,6-bis(8-hexylbenzimidazol-2-yl)pyridine}, pure substance -> True, CAS -> \
MISSING, InChIKey -> \
InChI=1S/C25H25N5/c1-2-3-4-9-17-30-23-16-8-7-13-20(23)29-25(30)22-15-10-14-21(\
26-22)24-27-18-11-5-6-12-19(18)28-24/h5-8,10-16H,2-4,9,17H2,1H3,(H,27,28), \
InChI -> InChI=1S/C25H25N5/c1-2-3-4-9-17-30-23-16-8-7-13-20(23)29-25(30)22-15-\
10-14-21(26-22)24-27-18-11-5-6-12-19(18)28-24/h5-8,10-16H,2-4,9,17H2,1H3,(H,\
27,28), SMILES -> N1C(=NC2=C1C=CC=C2)C2=CC=CC(=N2)C2=NC1=C(N2CCCCCC)C=CC=C1, \
PubchemCID -> MISSING, URL -> MISSING|>]\"\>", "]"}], ",", 
      RowBox[{
      "TestObject", 
       "[", "\<\"consistentInChIKeyInChIQ[<|names -> \
{2,2'-(4-(dodecyloxy)pyridine-2,6-diyl)bis(1H-benzo[d]imidazole), \
2-[6-(1H-benzimidazol-2-yl)-4-dodecoxypyridin-2-yl]-1H-benzimidazole}, pure \
substance -> True, CAS -> MISSING, InChIKey -> ZXIZCPCBUVGMMQ-UHFFFAOYSA-N), \
InChI -> InChI=1S/C31H37N5O/c1-2-3-4-5-6-7-8-9-10-15-20-37-23-21-28(30-33-24-\
16-11-12-17-25(24)34-30)32-29(22-23)31-35-26-18-13-14-19-27(26)36-31/h11-14,\
16-19,21-22H,2-10,15,20H2,1H3,(H,33,34)(H,35,36), SMILES -> \
N1C(=NC2=C1C=CC=C2)C2=CC(=CC(=N2)C2=NC1=C(N2)C=CC=C1)OCCCCCCCCCCCC, \
PubchemCID -> MISSING, URL -> MISSING|>]\"\>", "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.903770189745874*^9, 3.903770205567177*^9}, {
   3.903770443255468*^9, 3.903770452028363*^9}, {3.9037706913333197`*^9, 
   3.903770705856444*^9}, 3.903770744544853*^9, 3.903770836100936*^9, 
   3.90492277363162*^9, 3.9052699653297987`*^9, 3.905270248720551*^9, 
   3.905270493746697*^9, 3.9052706591858788`*^9, 3.9052707887103367`*^9, 
   3.905329987258053*^9, 3.905512713741136*^9, 3.905512855005275*^9, 
   3.9055192522803783`*^9, 3.90551939240362*^9, 3.905519730710924*^9, 
   3.9055201823250027`*^9, 3.905520590271069*^9, 3.905520686389163*^9, 
   3.9055207615931273`*^9, 3.905521443263473*^9, 3.905521484340061*^9, 
   3.905521649662311*^9, 3.905521855099844*^9, 3.905522151225142*^9, 
   3.905524357441049*^9, 3.905524518910668*^9},
 CellLabel->
  "Out[550]=",ExpressionUUID->"98371230-7f09-4c57-a60d-c46a2bc3f72d"],

Cell[BoxData["13"], "Output",
 CellChangeTimes->{{3.903770189745874*^9, 3.903770205567177*^9}, {
   3.903770443255468*^9, 3.903770452028363*^9}, {3.9037706913333197`*^9, 
   3.903770705856444*^9}, 3.903770744544853*^9, 3.903770836100936*^9, 
   3.90492277363162*^9, 3.9052699653297987`*^9, 3.905270248720551*^9, 
   3.905270493746697*^9, 3.9052706591858788`*^9, 3.9052707887103367`*^9, 
   3.905329987258053*^9, 3.905512713741136*^9, 3.905512855005275*^9, 
   3.9055192522803783`*^9, 3.90551939240362*^9, 3.905519730710924*^9, 
   3.9055201823250027`*^9, 3.905520590271069*^9, 3.905520686389163*^9, 
   3.9055207615931273`*^9, 3.905521443263473*^9, 3.905521484340061*^9, 
   3.905521649662311*^9, 3.905521855099844*^9, 3.905522151225142*^9, 
   3.905524357441049*^9, 3.9055245189135847`*^9},
 CellLabel->
  "Out[551]=",ExpressionUUID->"5018dfe3-6365-4174-b2b9-2163c9461ff8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Are there duplicates within a dictionary? (as measured by InChIKey)\
\>", "Subsection",
 CellChangeTimes->{{3.903770005937648*^9, 3.903770023067606*^9}, {
  3.905330171917543*^9, 
  3.905330175767272*^9}},ExpressionUUID->"5d8b0a9b-5244-4b41-93f0-\
8f40c5863a80"],

Cell["\<\
Check each individual file for duplicate InChI Keys within that file\
\>", "Text",
 CellChangeTimes->{{3.9053301449427967`*^9, 
  3.905330158485262*^9}},ExpressionUUID->"bc2b643f-59b4-45b1-acbb-\
72717aa08a97"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"singleDictionaryDuplicates", "[", "d_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"inchikeys", " ", "=", " ", 
       RowBox[{"Normal", "@", 
        RowBox[{"DeleteMissing", "@", 
         RowBox[{"d", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<InChIKey\>\""}], "]"}], "]"}]}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"GreaterThan", "[", "1", "]"}], "]"}], "@", 
      RowBox[{"Counts", "@", "inchikeys"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"failureSummary", "[", 
   RowBox[{
   "singleDictionaryDuplicates", ",", "dictionaryFiles", ",", "data"}], "]"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{"Values", "@", "#"}]}], "&"}], ",", "%"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Total", "@", 
  RowBox[{"Values", "@", "%"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.905329594418996*^9, 3.905329663357189*^9}, {
  3.9053297254871197`*^9, 3.90532976529368*^9}, {3.9053298040003977`*^9, 
  3.905329890864258*^9}, {3.905329993072139*^9, 3.905330139750545*^9}},
 CellLabel->
  "In[552]:=",ExpressionUUID->"cc0c90a6-3fb2-406a-b891-ab583ebd3e20"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records.json\"\>", 
    "\[Rule]", 
    RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_OV.json\"\>",
     "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"VRZYWIAVUGQHKB-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
      RowBox[{"\<\"HIELYQQIYOVIAZ-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}]}], 
     "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_RM.json\"\>",
     "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{"\<\"QSFRTQJEHPGZSO-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], 
     "\[RightAssociation]"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.905329596412023*^9, 3.905329666026807*^9}, 
   3.905329742446958*^9, 3.905330017878477*^9, {3.905330069796618*^9, 
   3.9053301401677647`*^9}, 3.9055127139629707`*^9, 3.905512855221924*^9, 
   3.905519252499288*^9, 3.9055193926181517`*^9, 3.9055197309196787`*^9, 
   3.905520182534534*^9, 3.905520590480686*^9, 3.905520686636778*^9, 
   3.9055207618031816`*^9, 3.905521443472938*^9, 3.905521484548978*^9, 
   3.9055216498729277`*^9, 3.905521855309548*^9, 3.9055221514337378`*^9, 
   3.905524357650757*^9, 3.90552451891827*^9},
 CellLabel->
  "Out[553]=",ExpressionUUID->"0e9cd64d-eb75-411b-ba0f-0bbc780651e9"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records.json\"\>", 
    "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_OV.json\"\>",
     "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"../chemical_dictionaries/chem_dictionary_records_RM.json\"\>",
     "\[Rule]", "1"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.905329596412023*^9, 3.905329666026807*^9}, 
   3.905329742446958*^9, 3.905330017878477*^9, {3.905330069796618*^9, 
   3.9053301401677647`*^9}, 3.9055127139629707`*^9, 3.905512855221924*^9, 
   3.905519252499288*^9, 3.9055193926181517`*^9, 3.9055197309196787`*^9, 
   3.905520182534534*^9, 3.905520590480686*^9, 3.905520686636778*^9, 
   3.9055207618031816`*^9, 3.905521443472938*^9, 3.905521484548978*^9, 
   3.9055216498729277`*^9, 3.905521855309548*^9, 3.9055221514337378`*^9, 
   3.905524357650757*^9, 3.90552451891961*^9},
 CellLabel->
  "Out[554]=",ExpressionUUID->"25f81d2d-cf0c-4cd6-a388-f758f9da4baa"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.905329596412023*^9, 3.905329666026807*^9}, 
   3.905329742446958*^9, 3.905330017878477*^9, {3.905330069796618*^9, 
   3.9053301401677647`*^9}, 3.9055127139629707`*^9, 3.905512855221924*^9, 
   3.905519252499288*^9, 3.9055193926181517`*^9, 3.9055197309196787`*^9, 
   3.905520182534534*^9, 3.905520590480686*^9, 3.905520686636778*^9, 
   3.9055207618031816`*^9, 3.905521443472938*^9, 3.905521484548978*^9, 
   3.9055216498729277`*^9, 3.905521855309548*^9, 3.9055221514337378`*^9, 
   3.905524357650757*^9, 3.905524518920599*^9},
 CellLabel->
  "Out[555]=",ExpressionUUID->"6d34b8ec-cf6c-44e3-af7e-75701199625a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Are there duplicates between dictionary? (as measured by InChIKey)\
\>", "Subsection",
 CellChangeTimes->{{3.903770005937648*^9, 3.903770023067606*^9}, {
  3.905330171917543*^9, 
  3.905330184118992*^9}},ExpressionUUID->"bcc8456a-50fe-4c5e-86e4-\
47c077c86163"],

Cell["\<\
Combine all of the dictionaries together and identify duplicated InChIKeys.  \
Note that this will be less bad once duplicates in the previous stage are \
removed.\
\>", "Text",
 CellChangeTimes->{{3.905330246010898*^9, 3.9053302498594646`*^9}, {
  3.9053303697368813`*^9, 
  3.905330409669223*^9}},ExpressionUUID->"25c8f363-f196-487b-a524-\
6d6a717ebaae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{"GreaterThan", "[", "1", "]"}], "]"}], "@", 
   RowBox[{"Counts", "@", 
    RowBox[{"DeleteMissing", "@", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Normal", "@", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "\"\<InChIKey\>\""}], "]"}], "]"}], "&"}], 
         "]"}], "@", "data"}]}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.905330197786865*^9, 3.905330358293441*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"431630f5-9770-4104-9655-dece1d2fb287"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"KRKNYBCHXYNGOX-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"KBPLFHHGFOOTCA-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"VRZYWIAVUGQHKB-UHFFFAOYSA-N\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"YNFBMDWHEHETJW-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"DOCWBIUEXDRWEJ-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"BBGKDYHZQOSNMU-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"QSFRTQJEHPGZSO-UHFFFAOYSA-N\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"FSGXOTSTBMUIOR-UHFFFAOYSA-N\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"STCOOQWBFONSKY-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"HIELYQQIYOVIAZ-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"YFMTUEQOIRXZOE-UHFFFAOYSA-N\"\>", "\[Rule]", "2"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.905330243007758*^9, 3.9053303592412453`*^9}, 
   3.905512713986617*^9, 3.9055128552458067`*^9, 3.905519252522429*^9, 
   3.905519392643078*^9, 3.905519730942111*^9, 3.905520182557156*^9, 
   3.905520590497349*^9, 3.9055206866538687`*^9, 3.90552076182863*^9, 
   3.905521443496212*^9, 3.905521484572236*^9, 3.905521649889832*^9, 
   3.905521855327406*^9, 3.90552215145609*^9, 3.9055243576744213`*^9, 
   3.905524518941819*^9},
 CellLabel->
  "Out[556]=",ExpressionUUID->"5c55abcc-fa5f-447b-aafa-588f2b26b580"],

Cell[BoxData["11"], "Output",
 CellChangeTimes->{{3.905330243007758*^9, 3.9053303592412453`*^9}, 
   3.905512713986617*^9, 3.9055128552458067`*^9, 3.905519252522429*^9, 
   3.905519392643078*^9, 3.905519730942111*^9, 3.905520182557156*^9, 
   3.905520590497349*^9, 3.9055206866538687`*^9, 3.90552076182863*^9, 
   3.905521443496212*^9, 3.905521484572236*^9, 3.905521649889832*^9, 
   3.905521855327406*^9, 3.90552215145609*^9, 3.9055243576744213`*^9, 
   3.90552451894333*^9},
 CellLabel->
  "Out[557]=",ExpressionUUID->"0a2ba3ef-6047-4cfa-8aae-b7cc29f88317"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 747},
WindowMargins->{{119, Automatic}, {16, Automatic}},
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0c27e109-868e-4822-b98c-59565a66b3d7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 253, 4, 35, "Text",ExpressionUUID->"925c1885-c287-4ece-b81e-bc46194e91c9"],
Cell[CellGroupData[{
Cell[836, 28, 687, 18, 73, "Input",ExpressionUUID->"db7113a8-effc-40c0-af70-fa30b71f7276"],
Cell[1526, 48, 849, 14, 77, "Output",ExpressionUUID->"0c7e85e0-8322-41cf-95cd-e6b6ca6ac73c"]
}, Open  ]],
Cell[2390, 65, 224, 5, 35, "Text",ExpressionUUID->"cbf1fb47-5901-43e6-bcb6-e2facc7a0561"],
Cell[CellGroupData[{
Cell[2639, 74, 237, 5, 30, "Input",ExpressionUUID->"e429c4d5-65bf-4ad2-b5e0-14471adbc965"],
Cell[2879, 81, 610, 9, 34, "Output",ExpressionUUID->"420f627a-e018-49de-a708-888355f07301"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3526, 95, 178, 3, 67, "Section",ExpressionUUID->"d80460e8-fc45-4104-a610-9bd97b802477"],
Cell[3707, 100, 1894, 48, 220, "Input",ExpressionUUID->"84bba290-fb89-4efc-b0f1-6ddcc7684a09"],
Cell[CellGroupData[{
Cell[5626, 152, 310, 5, 54, "Subsection",ExpressionUUID->"28762df5-e4b4-4f72-99ad-c524ac3638b0"],
Cell[CellGroupData[{
Cell[5961, 161, 3497, 79, 325, "Input",ExpressionUUID->"5ab76055-3318-401c-8e6a-03891cd63381"],
Cell[9461, 242, 1332, 24, 77, "Output",ExpressionUUID->"617d9ae4-9e52-4e97-90e5-74539a6431af"],
Cell[10796, 268, 1329, 24, 77, "Output",ExpressionUUID->"36115a02-1e70-4f40-8504-ad405b6c2c14"],
Cell[12128, 294, 889, 13, 34, "Output",ExpressionUUID->"5b0d4cc4-2021-4893-b045-3569bea1928f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13066, 313, 328, 6, 54, "Subsection",ExpressionUUID->"319f24c7-668c-4a30-889d-8af936bafdfc"],
Cell[CellGroupData[{
Cell[13419, 323, 3416, 83, 451, "Input",ExpressionUUID->"3f969449-edf4-4c2b-bfd2-7eb46e654ba9"],
Cell[16838, 408, 5977, 110, 1463, "Output",ExpressionUUID->"93ac58a7-c314-4b56-b15c-3ba2fa704b0e"],
Cell[22818, 520, 4360, 80, 1043, "Output",ExpressionUUID->"98371230-7f09-4c57-a60d-c46a2bc3f72d"],
Cell[27181, 602, 874, 13, 34, "Output",ExpressionUUID->"5018dfe3-6365-4174-b2b9-2163c9461ff8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28104, 621, 272, 6, 54, "Subsection",ExpressionUUID->"5d8b0a9b-5244-4b41-93f0-8f40c5863a80"],
Cell[28379, 629, 220, 5, 35, "Text",ExpressionUUID->"bc2b643f-59b4-45b1-acbb-72717aa08a97"],
Cell[CellGroupData[{
Cell[28624, 638, 1413, 36, 199, "Input",ExpressionUUID->"cc0c90a6-3fb2-406a-b891-ab583ebd3e20"],
Cell[30040, 676, 1454, 27, 119, "Output",ExpressionUUID->"0e9cd64d-eb75-411b-ba0f-0bbc780651e9"],
Cell[31497, 705, 1041, 18, 77, "Output",ExpressionUUID->"25f81d2d-cf0c-4cd6-a388-f758f9da4baa"],
Cell[32541, 725, 661, 10, 34, "Output",ExpressionUUID->"6d34b8ec-cf6c-44e3-af7e-75701199625a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33251, 741, 271, 6, 54, "Subsection",ExpressionUUID->"bcc8456a-50fe-4c5e-86e4-47c077c86163"],
Cell[33525, 749, 366, 8, 58, "Text",ExpressionUUID->"25c8f363-f196-487b-a524-6d6a717ebaae"],
Cell[CellGroupData[{
Cell[33916, 761, 723, 20, 94, "Input",ExpressionUUID->"431630f5-9770-4104-9655-dece1d2fb287"],
Cell[34642, 783, 1436, 23, 140, "Output",ExpressionUUID->"5c55abcc-fa5f-447b-aafa-588f2b26b580"],
Cell[36081, 808, 559, 9, 57, "Output",ExpressionUUID->"0a2ba3ef-6047-4cfa-8aae-b7cc29f88317"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

